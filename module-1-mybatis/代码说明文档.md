



# 题目 
## 请完善自定义持久层框架IPersistence，在现有代码基础上添加、修改及删除功能。【需要采用getMapper方式】

---

### 1.首先需要再xml中添加对应操作的statement，如图

<img src="/Users/mac/Library/Application Support/typora-user-images/image-20200424120208292.png" alt="image-20200424120208292" style="zoom:50%;" />



### 2.添加完之后修改xml解析工具类XMLMapperBuilder，原先只支持select标签解析，先需要增加其他类型 并且在MappedStatement对象中增加sqlCommandType用于后续执行时的区分

![image-20200424120439556](/Users/mac/Library/Application Support/typora-user-images/image-20200424120439556.png)



### 3.在DefaultSqlSession对象中新增update方法。

![image-20200424120648991](/Users/mac/Library/Application Support/typora-user-images/image-20200424120648991.png)



### 4.在执行时判断xml节点标签判断调用的方法

![image-20200424121045736](/Users/mac/Library/Application Support/typora-user-images/image-20200424121045736.png)

### 5.在SimpleExecutor对象中增加doUpdate方法。为适配删除直接传id的场景。做了如果parameterType是基础类型时直接赋值的优化

![image-20200424120859009](/Users/mac/Library/Application Support/typora-user-images/image-20200424120859009.png)





### 测试结果

----

原数据

![image-20200424121220937](/Users/mac/Library/Application Support/typora-user-images/image-20200424121220937.png)



1.执行更新方法

![image-20200424121514599](/Users/mac/Library/Application Support/typora-user-images/image-20200424121514599.png)

执行结果

![image-20200424121540086](/Users/mac/Library/Application Support/typora-user-images/image-20200424121540086.png)



2.执行删除方法

![image-20200424121620919](/Users/mac/Library/Application Support/typora-user-images/image-20200424121620919.png)

执行结果

![image-20200424121629036](/Users/mac/Library/Application Support/typora-user-images/image-20200424121629036.png)

由于外键原因删除没有成功，但是已正常执行



3.执行新增方法

![image-20200424121713047](/Users/mac/Library/Application Support/typora-user-images/image-20200424121713047.png)



执行结果![image-20200424121732191](/Users/mac/Library/Application Support/typora-user-images/image-20200424121732191.png)